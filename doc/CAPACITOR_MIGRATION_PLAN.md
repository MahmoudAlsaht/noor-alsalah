# ๐ฑ ุฎุทุฉ ุงูุชุญููู ุฅูู ุชุทุจูู ุฃูุฏุฑููุฏ (Capacitor Migration Plan)

## ๐ฏ ุงูููุฎุต
ุงููุฏู ูู ุชุญููู ูุดุฑูุน "ููุฑ ุงูุตูุงุฉ" ูู PWA ูุนุชูุฏ ุนูู ุงููุชุตูุญ ุฅูู ุชุทุจูู ุฃูุฏุฑููุฏ ุญูููู (Native Android App) ุจุงุณุชุฎุฏุงู **Capacitor**.
ุณูุชูุญ ูุฐุง ุงููุตูู ูููุฒุงุช ุงููุธุงู ุงูุญููููุฉ ูุซู **ุงูููุจู ุงูุฏููู (AlarmManager)** ู **ุงูููุฏุฌุช (Homescreen Widgets)**ุ ูุน ุงูุฅุจูุงุก ุนูู ูุณุฎุฉ ุงูููุจ ููุงุฌูุฉ ุนุฑุถ ุจุณูุทุฉ ุชุญุชูู ุนูู ุฑุงุจุท ุงูุชุญููู.

---

## ๐๏ธ ุงููุฑุญูุฉ 1: ุงูุชุฌููุฒ ููุตู ุงูุจูุฆุงุช

ุณูููู ุจุฌุนู ุงูููุฏ "ุฐูู" ููุนุฑู ูู ูู ูุนูู ุฏุงุฎู ุชุทุจูู ุฃู ุนูู ุงููุชุตูุญ.

1. **ุชุซุจูุช Capacitor**:
   - ุชุซุจูุช ุงูุญุฒู ุงูุฃุณุงุณูุฉ: `@capacitor/core`, `@capacitor/cli`, `@capacitor/android`.
   - ุชููุฆุฉ ุงููุดุฑูุน: `npx cap init`.

2. **ุชุฌููุฒ Next.js**:
   - ุชุนุฏูู `next.config.js` ูุฏุนู ุงูุชุตุฏูุฑ ุงูุซุงุจุช (`output: 'export'`) ูุฃู Capacitor ูุง ูุดุบู ุณูุฑูุฑ Node.js.
   - ุชุนุทูู ุงูู `<Image />` optimization ุงูุงูุชุฑุงุถู ูุงุณุชุฎุฏุงู `unoptimized: true` ููุตูุฑ.

3. **ุฅุฏุงุฑุฉ ุงูุญุงูุฉ (Web vs Native)**:
   - ุฅูุดุงุก ุฏุงูุฉ ูุณุงุนุฏุฉ `isNativeApp()` ุจุงุณุชุฎุฏุงู `Capacitor.isNativePlatform()`.
   - **ูู ุงูููุจ**:
     - ุฅุฎูุงุก ุตูุญุฉ `/alarm`.
     - ุฅุฎูุงุก ุฎูุงุฑุงุช ุงูุชูุจููุงุช ุงููุชูุฏูุฉ ูู `/settings`.
     - ุนุฑุถ ุฒุฑ ุจุงุฑุฒ: "๐ฅ ุชุญููู ุชุทุจูู ุงูุฃูุฏุฑููุฏ".
   - **ูู ุงูุชุทุจูู**:
     - ุชูุนูู ูุงูุฉ ุงูููุฒุงุช ุงููุชูุฏูุฉ.
     - ุฅุฎูุงุก ุฒุฑ ุงูุชุญููู.

---


## โฐ ุงููุฑุญูุฉ 2: ูุธุงู ุงูุชูุจููุงุช ุงูุฃุตูู (Native Alarms)

ูุดููุฉ ุงูููุจ ุงูุญุงููุฉ ูู ุฃู ุงููุชุตูุญ ููุชู ุงูุนูููุงุช ูู ุงูุฎูููุฉ ูุชูููุฑ ุงูุจุทุงุฑูุฉ. ุงูุญู ูู ุงุณุชุฎุฏุงู **System AlarmManager**.

1. **ุฅุฒุงูุฉ ูุธุงู ุงูู Service Worker ุงููุฏูู (ููุชุทุจูู)**:
   - ุณูููู ุงูุงุนุชูุงุฏ ุนูู `Notification API` ุงูุฎุงุตุฉ ุจุงููุชุตูุญ ุฏุงุฎู ุงูุชุทุจูู.

2. **ุชุซุจูุช ุฅุถุงูุฉ (Plugin)**:
   - ุณูุณุชุฎุฏู ุฅุถุงูุฉ ูุซู `@capacitor-community/local-notifications` ุฃู ุฅุถุงูุฉ ูุฎุตุตุฉ ููุฃุฐุงู (ูุฏ ูุญุชุงุฌ ููุชุงุจุฉ ููุฏ ุจุณูุท Native ุฅุฐุง ูู ุชูุจู ุงูุฅุถุงูุงุช ุงูุญุงุฌุฉ "Exact Alarm").
   - **ุงูููุฒุฉ**: ูุฐุง ุงูููุจู ูุนูู 100% ุญุชู ูู ุงููุณุชุฎุฏู ุฃุบูู ุงูุชุทุจูู ูู ุงูุฎูููุฉ (Kill App).

3. **ุชุนุฏูู `useNotifications`**:
   - ุณูุตุจุญ ุงูู Hook ููุฌู ุงูุฃูุงูุฑ:
     - ุฅุฐุง `isNative`: ุงุณุชุฏุนุงุก `CapacitorPlugins.LocalNotifications.schedule(...)`.
     - ุฅุฐุง `Web`: ูุง ุชูุนู ุดูุฆุงู (ุฃู ุนุฑุถ ุชูุจูู ุจุณูุท ููุท).

---

## ๐งฉ ุงููุฑุญูุฉ 3: ุงูููุฏุฌุช (Android Widget)

ุงูููุฏุฌุช ูุง ูููุชุจ ุจู Reactุ ุจู ุจู **Kotlin/XML**. ููู ูุง ุชูููุ ุงูุฎุทูุงุช ูุญุฏุฏุฉ:

1. **ูุดุงุฑูุฉ ุงูุจูุงูุงุช (Shared Data)**:
   - ุณูุณุชุฎุฏู ุฅุถุงูุฉ `capacitor-shared-preferences` ูุญูุธ ุฃููุงุช ุงูุตูุงุฉ ุงููุญุณูุจุฉ ูู ุงูู React.
   - ูุฐู ุงูุจูุงูุงุช ุณุชูุฎุฒู ูู ูุณุงุญุฉ ูุดุชุฑูุฉ ูู ุฐุงูุฑุฉ ุงููุงุชู.

2. **ุจูุงุก ุงูููุฏุฌุช (Native Side)**:
   - ุณููุชุญ ูุฌูุฏ `android` ูู Android Studio.
   - ููุดุฆ ููู `PrayerWidgetProvider.kt`.
   - ูุจุฑูุฌ ุงูููุฏุฌุช ูููุฑุฃ ุงูุฃููุงุช ูู `SharedPreferences` ููุนุฑุถูุง.
   - ุณูุตูู `widget_layout.xml` ููุดุจู ุชุตููู ุงููููุน (ููุณ ุงูุฃููุงู ูุงูุฎุทูุท).

---

## ๐๏ธ ุงููุฑุญูุฉ 4: ุงูุชูุธูู ูุงูุฅูุชุงุฌ

1. **ุฅูุบุงุก PWA (ููุชุทุจูู)**:
   - ุญุฐู ุฃู ุชุนุทูู ุชุณุฌูู `service-worker.js` ุนูุฏ ุงูุนูู ุฏุงุฎู Capacitor ูุชุฌูุจ ุงูุชุนุงุฑุถ.

2. **ุจูุงุก ุงูู APK**:
   - ุชุดุบูู ุงูุฃูุฑ `npx cap sync`.
   - ูุชุญ Android Studio ูุจูุงุก `Signed APK`.
   - ุฑูุน ููู ุงูู APK ุนูู ุงุณุชุถุงูุฉ ุงููููุน (ูู ูุฌูุฏ `public/downloads`).

---

## ๐ ููุฎุต ุงูุฎุทูุงุช ููุฌูุณุฉ ุงููุงุฏูุฉ

ุนูุฏูุง ูุจุฏุฃ ุงูุฌูุณุฉ ุงููุงุฏูุฉุ ุงุทูุจ ููู: **"ุงุจุฏุฃ ุจุชูููุฐ ุฎุทุฉ Capacitor ุงููุฑุญูุฉ 1"**.

### ูุงุฆูุฉ ุงูููุงู ุงููุชููุนุฉ:
- [x] ุชุซุจูุช Capacitor ูุชููุฆุชู ููุฃูุฏุฑููุฏ.
- [x] ุชุนุฏูู `next.config.js` ููุฏุนู Static Export.
- [ ] ุฅูุดุงุก ูููู `DownloadButton` ูุธูุฑ ููุท ูู ุงูููุจ.
- [x] ุชุนุฏูู `useNotifications` ูุฏุนู ุงูููุทู ุงูุดุฑุทู (Web vs Native).

- [ ] ุงูุจุญุซ ุนู ูุชุฑููุจ ุฃูุถู Plugin ููููุจูุงุช ุงูุฏูููุฉ (Exact Alarms).
- [ ] ูุชุงุจุฉ ููุฏ ุงูู Widget ูู ุฃูุฏุฑููุฏ ุณุชูุฏูู (ุณุฃุนุทูู ุงูููุฏ ูุงููุงู ููุณุฎู).
